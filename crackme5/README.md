crackme5
---

In this program, we enter a username, and we attempt to find out what the serial number is.

By using Ollydbg to animiate through, we find out where to put the breakpoints when a username and serial is entered, and the "check" button is clicked.

![image](https://user-images.githubusercontent.com/7328587/119658117-5a3c3d80-be5f-11eb-815a-255d90151cbe.png)

line `0040110A` is the start of the function block when "check" is pressed

### String comparison
<hr>

In lines `00401190` through `004011AA`, we can see that it's doing a string comaparison with the string stored in `eax` and `ecx`.

In each iteration, the program compares two characters at a time, before incrementing the string incidces by 2.

On line `00401190`, the first character of the input is moved to `dl` and it is compared to the first character of actual answer on `00401192`

On line `0040119A`, the second character of the input is moved to `dl` and it is compared to the second character of actual answer on `0040119D`

On lines `004011A2` and `004011A5`, the indices of the input string and the actual string is incremented by 2, because a single character takes up 1 byte, and since in each iteration we compare two characters, the incidices should increase by 2.


### Getting the correct serial
<hr>

In line `0040114D`, we see that the program call `GetLocalTime` function

Further, in line `0040116A`, we see that there is a string formatting of `%s-%d%d%d`.

We can deduce that the serial is a combination of the username you entered, appened by numbers generated by `GetLocalTime`

While running the program, Ollydbg shows you any strings that are being generated and stored, and from this we can see the string being generated as we step through the program

![image](https://user-images.githubusercontent.com/7328587/119660784-33cbd180-be62-11eb-904f-8419e0033bb8.png)

In this case, we entered `aaa` as the username, and the program has generated the serial key `aaa-3255526`. It then performs the string comparison to see if the entered serial number matches this string.
